# ============================================================================
# GeneQR Platform - Environment Configuration Example
# ============================================================================
# Copy this file to .env and fill in your actual values
# DO NOT commit .env file to git!

# ============================================================================
# CORE APPLICATION
# ============================================================================
APP_ENV=development
APP_VERSION=2.0.0
PORT=8081
SHUTDOWN_TIMEOUT_SEC=30
ENABLED_MODULES=*

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8081

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=medplatform
DB_MAX_CONNS=10
DB_MAX_IDLE_TIME=5m
DB_QUERY_TIMEOUT=10s
DB_SSLMODE=disable

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================
REDIS_ADDR=localhost:6379
REDIS_PASSWORD=
REDIS_DB=0

# ============================================================================
# KAFKA CONFIGURATION
# ============================================================================
KAFKA_BROKERS=localhost:9092
KAFKA_TOPIC=medical-platform
KAFKA_GROUP_ID=medical-platform-group

# ============================================================================
# KEYCLOAK CONFIGURATION
# ============================================================================
KEYCLOAK_URL=http://localhost:8080
KEYCLOAK_REALM=master
KEYCLOAK_CLIENT_ID=api-gateway
KEYCLOAK_CLIENT_SECRET=

# ============================================================================
# OBSERVABILITY CONFIGURATION
# ============================================================================
LOG_LEVEL=info
TRACING_ENABLED=true
TRACING_URL=http://localhost:4317
TRACING_SAMPLING_RATE=0.1
METRICS_ENABLED=true

# ============================================================================
# AI SERVICES CONFIGURATION
# ============================================================================

# Provider Settings
AI_PROVIDER=openai
AI_FALLBACK_PROVIDER=anthropic

# API Keys (REQUIRED for AI features)
# Get OpenAI key from: https://platform.openai.com/api-keys
# Get Anthropic key from: https://console.anthropic.com/
AI_OPENAI_API_KEY=sk-...your-openai-key-here
AI_ANTHROPIC_API_KEY=sk-ant-...your-anthropic-key-here

# OpenAI Whisper (Audio transcription for WhatsApp audio messages)
# Same API key as above, used for audio-to-text conversion
OPENAI_API_KEY=sk-...your-openai-key-here
WHISPER_LANGUAGE=en  # Language code: en (English), hi (Hindi), es (Spanish), etc. Leave blank for auto-detect

# Model Selection
AI_OPENAI_MODEL=gpt-4
AI_ANTHROPIC_MODEL=claude-3-opus-20240229

# AI Behavior
AI_MAX_RETRIES=3
AI_TIMEOUT_SECONDS=30
AI_TEMPERATURE=0.7
AI_MAX_TOKENS=2000

# Cost Management
AI_COST_TRACKING_ENABLED=true

# Feedback Learning System
AI_FEEDBACK_PATTERN_THRESHOLD=3
AI_FEEDBACK_TEST_PERIOD_DAYS=7
AI_FEEDBACK_DEPLOY_THRESHOLD=5
AI_FEEDBACK_ROLLBACK_THRESHOLD=-5

# ============================================================================
# WHATSAPP INTEGRATION (Optional)
# ============================================================================
# Enable WhatsApp integration for ticket creation via messaging
# Supports: Text messages, Images, Audio messages (with transcription)
ENABLE_WHATSAPP=false

# Twilio WhatsApp Configuration
# Get credentials from: https://console.twilio.com
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=your_auth_token_here
TWILIO_WHATSAPP_NUMBER=whatsapp:+14155238886

# WhatsApp Settings
WHATSAPP_VERIFY_TOKEN=your-verify-token-123
WHATSAPP_MEDIA_DIR=./data/whatsapp  # Storage for audio files and other media
WHATSAPP_ACCESS_TOKEN=your_whatsapp_business_api_token  # For media download

# ============================================================================
# SENDGRID EMAIL CONFIGURATION
# ============================================================================
# Email service for notifications and reports
# Get API key from: https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
SENDGRID_FROM_EMAIL=noreply@aby-med.com
SENDGRID_FROM_NAME=ABY-MED Platform

# Admin Email for notifications
ADMIN_EMAIL=admin@aby-med.com

# ============================================================================
# TICKET TRACKING CONFIGURATION
# ============================================================================
# Public tracking URL base (for customer ticket tracking links)
TICKET_TRACKING_BASE_URL=https://servqr.com/track
FRONTEND_BASE_URL=https://servqr.com

# Tracking token expiry (days) - default 1825 (5 years)
TRACKING_TOKEN_EXPIRY_DAYS=1825

# ============================================================================
# MODULE FEATURE FLAGS
# ============================================================================
# Organizations module (bulk import, management)
ENABLE_ORG=true

# Equipment module (catalog, bulk import)
ENABLE_EQUIPMENT=true

# ============================================================================
# FEATURE FLAGS - EMAIL NOTIFICATIONS
# ============================================================================
# Master switch for email notifications
FEATURE_EMAIL_NOTIFICATIONS=false

# Ticket Creation Email (First email - enable when ready)
FEATURE_TICKET_CREATED_EMAIL=false

# Manual Notifications (Admin can send anytime - safe to enable)
FEATURE_MANUAL_NOTIFICATIONS=true

# Auto notifications on ticket updates (enable when mature)
FEATURE_AUTO_TICKET_UPDATES=false

# Daily digest of open tickets (enable when mature)
FEATURE_TICKET_DAILY_DIGEST=false

# Legacy notification flags (keep for compatibility)
FEATURE_EMAIL_TICKET_CREATED=false
FEATURE_EMAIL_ENGINEER_ASSIGNED=false
FEATURE_EMAIL_STATUS_CHANGED=false

# Future: SMS Notifications (via Twilio)
FEATURE_SMS_NOTIFICATIONS=false
FEATURE_SMS_TICKET_CREATED=false
FEATURE_SMS_ENGINEER_ASSIGNED=false
FEATURE_SMS_STATUS_CHANGED=false

# Future: WhatsApp Notifications
FEATURE_WHATSAPP_NOTIFICATIONS=false
FEATURE_WHATSAPP_TICKET_CREATED=false
FEATURE_WHATSAPP_ENGINEER_ASSIGNED=false
FEATURE_WHATSAPP_STATUS_CHANGED=false

# ============================================================================
# FEATURE FLAGS - DAILY REPORTS
# ============================================================================
# Master switch for daily reports
FEATURE_DAILY_REPORTS=false

# Individual report times
FEATURE_DAILY_REPORT_MORNING=false
FEATURE_DAILY_REPORT_EVENING=false

# ============================================================================
# DAILY REPORTS CONFIGURATION
# ============================================================================
# Report schedule (24-hour format HH:MM)
DAILY_REPORT_MORNING_TIME=09:00
DAILY_REPORT_EVENING_TIME=18:00

# Timezone (IANA timezone database)
# Examples: UTC, America/New_York, Europe/London, Asia/Kolkata
DAILY_REPORT_TIMEZONE=Asia/Kolkata

# Recipients (comma-separated email addresses)
DAILY_REPORT_RECIPIENTS=admin@aby-med.com,manager@aby-med.com,ops@aby-med.com

# ============================================================================
# NOTES
# ============================================================================
# AI Configuration:
# - For development, you can use mock AI provider: AI_PROVIDER=mock
# - Temperature controls AI creativity (0.0-1.0): lower = more deterministic
# - MaxTokens controls response length
# - Feedback thresholds control when AI improvements are deployed/rolled back
#
# WhatsApp Integration:
# - WhatsApp integration requires Twilio account with WhatsApp enabled
# - Set ENABLE_WHATSAPP=true to activate WhatsApp ticket creation
#
# Email Notifications:
# - Requires SendGrid account and API key
# - Start with all flags false, enable gradually in production
# - Recommended rollout: ticket_created → engineer_assigned → status_changed
# - Each notification type can be controlled independently
#
# Daily Reports:
# - Requires SendGrid configured
# - Reports sent twice daily to configured recipients
# - Contains 8 categories: tickets, priorities, engineers, equipment, performance, top lists, alerts, activity
# - Start with FEATURE_DAILY_REPORTS=false for testing
# - Enable morning reports first, then evening
#
# Feature Flag Rollout Strategy:
# Week 1: All flags false, monitor logs
# Week 2: Enable FEATURE_EMAIL_TICKET_CREATED only
# Week 3: Enable FEATURE_EMAIL_ENGINEER_ASSIGNED
# Week 4: Enable FEATURE_EMAIL_STATUS_CHANGED
# Week 5: Enable FEATURE_DAILY_REPORT_MORNING
# Week 6: Enable FEATURE_DAILY_REPORT_EVENING
# Week 7+: Full production with all features enabled
